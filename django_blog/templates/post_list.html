{% extends 'base.html' %}

{% block title %}Blog Posts{% endblock %}

{% block content %}
<h2>Blog Posts</h2>
{% if user.is_authenticated %}
<p><a href="{% url 'post_create' %}" class="create-post-link">Create New Post</a></p>
{% endif %}

{% for post in posts %}
<article class="post-card">
    <h3><a href="{% url 'post_detail' post.pk %}">{{ post.title }}</a></h3>
    <p class="post-meta">By {{ post.author.username }} on {{ post.published_date|date:"M d, Y" }}</p>
    {% if post.tags.all %}
    <div class="post-tags">
        {% for tag in post.tags.all %}
        <a href="{% url 'posts_by_tag' tag.name %}" class="tag-link">{{ tag.name }}</a>
        {% endfor %}
    </div>
    {% endif %}
    <p class="post-content">{{ post.content|truncatewords:50 }}</p>
    <div class="post-actions">
        <a href="{% url 'post_detail' post.pk %}">Read more</a>
        {% if user.is_authenticated and user == post.author %}
            <a href="{% url 'post_update' post.pk %}">Edit</a>
            <a href="{% url 'post_delete' post.pk %}" onclick="return confirm('Are you sure you want to delete this post?')">Delete</a>
        {% endif %}
    </div>
</article>
{% empty %}
<p>No posts available.</p>
{% endfor %}
{% endblock %}